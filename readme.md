# Скрипт для перевода расписания в календарь

## Алгоритм разворачивания сервиса:

1. Открыть код скрипта в Visual Studio Code

2. Открыть терминал внутри VS Code

3. Проверить наличие пaкетов NODE.js. В случае отсутствия установить их

```bash
brew install node
npm install --global yarn
```

4. Подтянуть используемые пакеты:

```bash
npm install
```

## Работа с кодом:
* В строках **1-5** есть поля, которые необходимо заполнить самостоятельно

```js
const group_name = ''; //Ввести название группы для красоты файлов
const week = 6; //Обновлять номер недели, для корректности выполнения кода
const date_start = 20231002; //Обновлять дату начала недели (Format: YYYYMMDD) для корректности формирования файла-календаря
const group_id = ''
const URL = `https://isu.ugatu.su/api/new_schedule_api/?schedule_semestr_id=231&WhatShow=1&student_group_id=1111&weeks=${week}` //Инструкцию по заполнению этого поля см. ниже
```

1. Для заполнения поля URL необходимо пройти по ссылке https://isu.ugatu.su/api/new_schedule_api, выбрать все необходимые параметры для показа расписания именно Вашей группы и скопировать всю строку из поисковой строки.
Получится что-то такое: ```https://isu.ugatu.su/api/new_schedule_api/?schedule_semestr_id=231&WhatShow=1&student_group_id=2340&weeks=5```

2. Стираем последнее число (оно показывает номер отслеживаемой недели) и заменяем на ```${week}```
3. Получаем файл get-запроса, корректный для вашей группы
```js
const URL = `https://isu.ugatu.su/api/new_schedule_api/?schedule_semestr_id=231&WhatShow=1&student_group_id=2340&weeks=${week}`
```

* В **строке 143** есть счётчик дней. В конце месяца его нужно обновлять
```js
    if (date == 20230930) date == 20231001; //Вот тут необходимо менять даты каждый месяц
    else date++;
```

## Результаты
* Файлы, содержащие код календаря будут находиться в той же папке, что и текущий скрипт (файл index.js)
* В случае, если каледнарь говорит, что нет мероприятий для вставки, значит из-за асинхронной работы скрипта кое-какие строки затёрлись. Для исправления можно попробовать ещё раз запустить скрипт. Если не помогло, то открываем файл через любой текстовый редактор и проверяем содержимое файла. Общий вид представлен ниже:

`BEGIN:VCALENDAR` – обязательное начало файла

`BEGIN:VEVENT` – начало блока мероприятия

`SUMMARY: бла-бла-бла` – название мероприятия

`DTSTART;VALUE=DATE-TIME:20231004T113500` – дата и время начала мероприятия в формате **YYYYMMDD**, **HHMMSS**

`DTEND;VALUE=DATE-TIME:20231004T125500` – дата и время окончания мероприятия
`END:VEVENT` – окончание блока мероприятия

`END:VCALENDAR` – обязательное окончание файла

* Пример файла:
```
BEGIN:VCALENDAR

BEGIN:VEVENT
SUMMARY: 6-304 Операционные системы и оболочки Лекция Валиахметова Ю. И.
DTSTART;VALUE=DATE-TIME:20231002T113500
DTEND;VALUE=DATE-TIME:20231002T125500
END:VEVENT

BEGIN:VEVENT
SUMMARY: 1-311 Основы программирования Лекция Касаткин А. А.
DTSTART;VALUE=DATE-TIME:20231002T131000
DTEND;VALUE=DATE-TIME:20231002T143000
END:VEVENT

END:VCALENDAR
```

## В качестве послесловия
Оставляю код на волю коммьюнити. Если есть работающие идеи по улучшению кода, то делайте коммиты.

Если есть вопросы по работе, то пишите мне в [телегу](t.me/neil_arms)